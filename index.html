<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>鹽分實驗室</title>
<!-- Orbitron 字型 -->
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet">
<style>
body {
  background: #000;
  color: #0ff;
  font-family: 'Orbitron', 'Consolas', monospace;
  margin: 0;
  padding: 20px;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
}
.game-title {
  font-size: 2.5em;
  margin-bottom: 10px;
  color: #0ff;
}
.neon-btn, .upgrade .neon-btn {
  background: #001a1a;
  border: 2px solid #0ff;
  color: #0ff;
  box-shadow: none;
  transition: none;
  animation: none;
}
.neon-btn:hover:not(:disabled) {
  background: rgba(0, 255, 255, 0.1);
}
.neon-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  border-color: #444;
}
.neon-btn:active {
  box-shadow: none;
}
.display {
  background: rgba(0, 0, 0, 0.5);
  border: 1px solid #0ff;
  padding: 15px;
  margin-bottom: 20px;
}
.upgrade .neon-btn {
  text-align: left;
  padding: 10px;
  margin: 5px 0;
  width: 100%;
}
.cooldown-container {
  position: relative;
  display: inline-block;
  margin: 10px 0;
}
.cooldown-ring {
  width: 60px;
  height: 60px;
  position: relative;
}
.cooldown-ring svg {
  transform: rotate(-90deg);
}
.cooldown-ring circle {
  fill: none;
  stroke-width: 4;
}
.cooldown-ring .background {
  stroke: rgba(0, 255, 255, 0.2);
}
.cooldown-ring .progress {
  stroke: #0ff;
  stroke-linecap: round;
  transition: stroke-dashoffset 0.1s linear;
}
.cooldown-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 0.9em;
  color: #0ff;
}
.version {
  position: fixed;
  bottom: 10px;
  right: 10px;
  color: #0ff;
  font-size: 0.8em;
  opacity: 0.7;
}
</style>
</head>
<body>
<button class="neon-btn language-switch" id="langSwitch">English</button>
<div class="container">
  <div class="game-title" data-zh="鹽分實驗室" data-en="Salt Laboratory">鹽分實驗室</div>
  <div class="game-desc" data-zh="你是一位鹽分研究員，正在研究不同鹽類在水中的溶解度..." data-en="You are a salt researcher studying the solubility of different salts in water...">你是一位鹽分研究員，正在研究不同鹽類在水中的溶解度...</div>
  <div class="display">
    <div id="energy" style="margin-bottom:0;font-size:2.2em;font-weight:bold;"
      data-zh="實驗數據" data-en="Experiment Data">實驗數據</div>
    <div id="currency-row" style="margin-bottom:20px;">
      <span data-zh="鹽分濃度：" data-en="Salt Concentration: ">鹽分濃度：</span>
      <span id="saltPpm">0</span> mg/L |
      <span data-zh="剩餘水量：" data-en="Water Volume: ">剩餘水量：</span>
      <span id="waterVolume">1000</span> L |
      <span data-zh="實驗點數：" data-en="Experiment Points: ">實驗點數：</span>
      <span id="expPoints">0</span> |
      <span data-zh="研究進度：" data-en="Research Progress: ">研究進度：</span>
      <span id="research">0</span>%
    </div>
  </div>
  <div class="upgrade">
    <div class="cooldown-container">
      <button class="neon-btn" id="addSaltBtn">
        <span data-zh="添加鹽分" data-en="Add Salt">添加鹽分</span>
      </button>
      <div class="cooldown-ring">
        <svg width="60" height="60">
          <circle class="background" cx="30" cy="30" r="27" fill="none" stroke="rgba(0, 255, 255, 0.2)" stroke-width="4"/>
          <circle class="progress" cx="30" cy="30" r="27" fill="none" stroke="#0ff" stroke-width="4" stroke-dasharray="169.6" stroke-dashoffset="0"/>
        </svg>
        <div class="cooldown-text" id="cooldownText">1000ms</div>
      </div>
    </div>
  </div>
  <div class="upgrade">
    <button class="neon-btn" id="naturalErosionBtn">
      <span data-zh="自然侵蝕" data-en="Natural Erosion">自然侵蝕</span>
      <br>
      <span data-zh="花費：" data-en="Cost: ">花費：</span><span class="upgrade-cost" id="naturalErosionCost">0.001</span> mg/L<br>
      <span data-zh="效果：" data-en="Effect: ">效果：</span>
      <span data-zh="每次點擊額外增加" data-en="Add extra">每次點擊額外增加</span>
      <span class="upgrade-effect" id="naturalErosionEffect">1.0</span>x
      <span data-zh="鹽分" data-en="salt">鹽分</span>
    </button>
    <div class="desc">
      <span data-zh="當前等級：" data-en="Current Level: ">當前等級：</span>
      <span id="naturalErosionLv">0</span>
    </div>
  </div>
  <div class="upgrade">
    <button class="neon-btn" id="evaporationBtn">
      <span data-zh="蒸發" data-en="Evaporation">蒸發</span>
      <br>
      <span data-zh="花費：" data-en="Cost: ">花費：</span><span class="upgrade-cost" id="evaporationCost">0.001</span> mg/L<br>
      <span data-zh="效果：" data-en="Effect: ">效果：</span>
      <span data-zh="每次點擊減少" data-en="Reduce">每次點擊減少</span>
      <span class="upgrade-effect" id="evaporationEffect">1.0</span>L
      <span data-zh="水量" data-en="water">水量</span>
    </button>
    <div class="desc">
      <span data-zh="當前等級：" data-en="Current Level: ">當前等級：</span>
      <span id="evaporationLv">0</span>
    </div>
  </div>
  <div class="upgrade">
    <button class="neon-btn" id="fasterLaborBtn">
      <span data-zh="加速勞動" data-en="Faster Labor">加速勞動</span>
      <br>
      <span data-zh="花費：" data-en="Cost: ">花費：</span><span class="upgrade-cost" id="fasterLaborCost">0.001</span> mg/L<br>
      <span data-zh="效果：" data-en="Effect: ">效果：</span>
      <span data-zh="減少" data-en="Reduce">減少</span>
      <span class="upgrade-effect" id="fasterLaborEffect">1000</span>ms
      <span data-zh="冷卻時間" data-en="cooldown">冷卻時間</span>
    </button>
    <div class="desc">
      <span data-zh="當前等級：" data-en="Current Level: ">當前等級：</span>
      <span id="fasterLaborLv">0</span>
    </div>
  </div>
  <div class="upgrade">
    <button class="neon-btn" id="autoDissolveBtn">
      <span data-zh="自動溶解" data-en="Auto Dissolve">自動溶解</span>
      <br>
      <span data-zh="花費：" data-en="Cost: ">花費：</span><span class="upgrade-cost" id="autoDissolveCost">0.001</span> mg/L<br>
      <span data-zh="效果：" data-en="Effect: ">效果：</span>
      <span data-zh="每秒自動添加" data-en="Auto add">每秒自動添加</span>
      <span class="upgrade-effect" id="autoDissolveEffect">0.0</span>/s
      <span data-zh="鹽分" data-en="salt">鹽分</span>
    </button>
    <div class="desc">
      <span data-zh="當前等級：" data-en="Current Level: ">當前等級：</span>
      <span id="autoDissolveLv">0</span>
    </div>
  </div>
  <div class="upgrade">
    <h2 style="margin-top:32px;" data-zh="研究進階" data-en="Research Progress">研究進階</h2>
    <div class="prestige-info">
      <div>
        <span data-zh="當前研究：" data-en="Current Research: ">當前研究：</span>
        <span id="currentResearch">鹽</span>
      </div>
      <div>
        <span data-zh="當前倍率：" data-en="Current Multiplier: ">當前倍率：</span>
        <span id="resetMultiplier">1.0</span>x
      </div>
      <div>
        <span data-zh="下次研究：" data-en="Next Research: ">下次研究：</span>
        <span id="nextResearch">糖</span>
      </div>
      <div>
        <span data-zh="重置後獲得：" data-en="After reset: ">重置後獲得：</span>
        <span id="nextMultiplier">1.5</span>x
        <span data-zh="倍率" data-en="multiplier">倍率</span>
      </div>
    </div>
    <button class="neon-btn" id="resetBtn"
      data-zh="重置研究"
      data-en="Reset Research">
      重置研究
    </button>
  </div>
  <div class="credits" data-zh="升級名稱由 you_3009 提供"
    data-en="Upgrade names by you_3009">
    升級名稱由 you_3009 提供
  </div>
</div>
<div class="footer">© 2024 鹽分實驗室 | 科學放置遊戲</div>
<div class="version">v1.8R-4k</div>
<script>
// 遊戲變量
let saltPpm = 0;
let waterVolume = 1000;
let expPoints = 0;
let research = 0;
let lastClickTime = 0;
let clickCooldown = 1000;
let naturalErosionLv = 0;
let evaporationLv = 0;
let fasterLaborLv = 0;
let autoDissolveLv = 0;
let prestigeLevel = 0;
let currentResearch = 0;
let researchProgress = 0;
let researchRequirement = 1000;
let prestigeTypes = ['鹽', '糖', '鉀', '鈣', '鎂'];
let lastUpdateTime = Date.now();
let autoDissolveTimer = null;
let currentLang = 'zh';

document.getElementById('langSwitch').addEventListener('click', function() {
  currentLang = currentLang === 'zh' ? 'en' : 'zh';
  updateLanguage();
  updateDisplay();
  updateUpgradeButtons();
  updatePrestigeInfo();
});
function updateLanguage() {
  document.querySelectorAll('[data-zh]').forEach(element => {
    element.textContent = element.getAttribute(`data-${currentLang}`);
  });
  document.getElementById('langSwitch').textContent =
    currentLang === 'zh' ? 'English' : '中文';
}
function updateCooldown() {
  const cooldownRing = document.querySelector('.cooldown-ring .progress');
  const cooldownText = document.getElementById('cooldownText');
  const addSaltBtn = document.getElementById('addSaltBtn');
  const now = Date.now();
  const elapsed = now - lastClickTime;
  const remaining = Math.max(0, clickCooldown - elapsed);
  const progress = remaining / clickCooldown;
  cooldownRing.style.strokeDashoffset = (169.6 * (1 - progress)).toString();
  if (remaining > 0) {
    cooldownText.textContent = Math.ceil(remaining) + 'ms';
    addSaltBtn.disabled = true;
    requestAnimationFrame(updateCooldown);
  } else {
    cooldownText.textContent = 'Ready';
    addSaltBtn.disabled = false;
  }
}
function updateDisplay() {
  document.getElementById('saltPpm').textContent = saltPpm.toFixed(3);
  document.getElementById('waterVolume').textContent = waterVolume.toFixed(1);
  document.getElementById('expPoints').textContent = expPoints.toFixed(0);
  document.getElementById('research').textContent = research.toFixed(1);
}
function updateUpgradeButtons() {
  // 自然侵蝕
  const naturalErosionCost = 0.001 * Math.pow(1.5, naturalErosionLv);
  document.getElementById('naturalErosionCost').textContent = naturalErosionCost.toFixed(3);
  document.getElementById('naturalErosionEffect').textContent = (1 + naturalErosionLv * 2).toFixed(1);
  document.getElementById('naturalErosionBtn').disabled = (saltPpm + 1e-8) < naturalErosionCost;
  document.getElementById('naturalErosionBtn').style.opacity = (saltPpm + 1e-8) < naturalErosionCost ? '0.5' : '1';
  document.getElementById('naturalErosionLv').textContent = naturalErosionLv;
  // 蒸發
  const evaporationCost = 0.001 * Math.pow(1.5, evaporationLv);
  document.getElementById('evaporationCost').textContent = evaporationCost.toFixed(3);
  document.getElementById('evaporationEffect').textContent = (1 + evaporationLv * 1).toFixed(1);
  document.getElementById('evaporationBtn').disabled = (saltPpm + 1e-8) < evaporationCost;
  document.getElementById('evaporationBtn').style.opacity = (saltPpm + 1e-8) < evaporationCost ? '0.5' : '1';
  document.getElementById('evaporationLv').textContent = evaporationLv;
  // 加速勞動
  const fasterLaborCost = 0.001 * Math.pow(1.5, fasterLaborLv);
  const newCooldown = Math.max(100, 1000 * Math.pow(0.9, fasterLaborLv + 1));
  document.getElementById('fasterLaborCost').textContent = fasterLaborCost.toFixed(3);
  document.getElementById('fasterLaborEffect').textContent = newCooldown.toFixed(0);
  document.getElementById('fasterLaborBtn').disabled = (saltPpm + 1e-8) < fasterLaborCost || newCooldown <= 100;
  document.getElementById('fasterLaborBtn').style.opacity = ((saltPpm + 1e-8) < fasterLaborCost || newCooldown <= 100) ? '0.5' : '1';
  document.getElementById('fasterLaborLv').textContent = fasterLaborLv;
  // 自動溶解
  const autoDissolveCost = 0.001 * Math.pow(1.5, autoDissolveLv);
  document.getElementById('autoDissolveCost').textContent = autoDissolveCost.toFixed(3);
  document.getElementById('autoDissolveEffect').textContent = (autoDissolveLv * 0.1).toFixed(1);
  document.getElementById('autoDissolveBtn').disabled = (saltPpm + 1e-8) < autoDissolveCost;
  document.getElementById('autoDissolveBtn').style.opacity = (saltPpm + 1e-8) < autoDissolveCost ? '0.5' : '1';
  document.getElementById('autoDissolveLv').textContent = autoDissolveLv;
}
document.getElementById('addSaltBtn').addEventListener('click', function(e) {
  const now = Date.now();
  if (now - lastClickTime >= clickCooldown) {
    const baseSalt = 0.1;
    const prestigeMultiplier = 1 + prestigeLevel * 0.5;
    const naturalErosionMultiplier = 1 + naturalErosionLv * 2;
    const addedSalt = baseSalt * prestigeMultiplier * naturalErosionMultiplier;
    saltPpm += addedSalt;
    lastClickTime = now;
    updateDisplay();
    updateCooldown();
    updateUpgradeButtons();
  }
});
document.getElementById('naturalErosionBtn').onclick = function() {
  const currentCost = 0.001 * Math.pow(1.5, naturalErosionLv);
  if ((saltPpm + 1e-8) >= currentCost) {
    saltPpm -= currentCost;
    naturalErosionLv++;
    updateDisplay();
    updateUpgradeButtons();
  }
};
document.getElementById('evaporationBtn').onclick = function() {
  const currentCost = 0.001 * Math.pow(1.5, evaporationLv);
  if ((saltPpm + 1e-8) >= currentCost) {
    saltPpm -= currentCost;
    evaporationLv++;
    updateDisplay();
    updateUpgradeButtons();
  }
};
document.getElementById('fasterLaborBtn').onclick = function() {
  const currentCost = 0.001 * Math.pow(1.5, fasterLaborLv);
  const newCooldown = Math.max(100, 1000 * Math.pow(0.9, fasterLaborLv + 1));
  if ((saltPpm + 1e-8) >= currentCost && newCooldown > 100) {
    saltPpm -= currentCost;
    fasterLaborLv++;
    clickCooldown = newCooldown;
    updateDisplay();
    updateUpgradeButtons();
  }
};
document.getElementById('autoDissolveBtn').onclick = function() {
  const currentCost = 0.001 * Math.pow(1.5, autoDissolveLv);
  if ((saltPpm + 1e-8) >= currentCost) {
    saltPpm -= currentCost;
    autoDissolveLv++;
    updateDisplay();
    updateUpgradeButtons();
  }
};
document.getElementById('resetBtn').addEventListener('click', function() {
  const baseCost = 1000 * Math.pow(1.5, prestigeLevel);
  if (saltPpm >= baseCost) {
    prestigeLevel++;
    currentResearch = Math.min(currentResearch + 1, prestigeTypes.length - 1);
    researchProgress = 0;
    researchRequirement = 1000 * Math.pow(1.5, prestigeLevel);
    naturalErosionLv = 0;
    evaporationLv = 0;
    fasterLaborLv = 0;
    autoDissolveLv = 0;
    saltPpm = 0;
    waterVolume = 1000;
    expPoints = 0;
    clickCooldown = 1000;
    updateDisplay();
    updateUpgradeButtons();
    updatePrestigeInfo();
  }
});
function updatePrestigeInfo() {
  document.getElementById('currentResearch').textContent = prestigeTypes[currentResearch];
  document.getElementById('resetMultiplier').textContent = (1 + prestigeLevel * 0.5).toFixed(1);
  document.getElementById('nextResearch').textContent = prestigeTypes[Math.min(currentResearch + 1, prestigeTypes.length - 1)];
  document.getElementById('nextMultiplier').textContent = (1 + (prestigeLevel + 1) * 0.5).toFixed(1);
}
function saveGame() {
  const gameState = {
    saltPpm,
    waterVolume,
    expPoints,
    researchProgress,
    prestigeLevel,
    naturalErosionLv,
    evaporationLv,
    fasterLaborLv,
    autoDissolveLv,
    currentResearch,
    lastUpdate: Date.now()
  };
  localStorage.setItem('saltLabSave', JSON.stringify(gameState));
}
function loadGame() {
  const savedGame = localStorage.getItem('saltLabSave');
  if (savedGame) {
    const gameState = JSON.parse(savedGame);
    Object.assign(window, gameState);
    const offlineTime = (Date.now() - gameState.lastUpdate) / 1000;
    if (offlineTime > 0) {
      const offlineGain = autoDissolveLv * 0.1 * offlineTime;
      saltPpm += offlineGain;
      updateDisplay();
    }
  }
}
setInterval(saveGame, 30000);
window.addEventListener('load', loadGame);
window.addEventListener('load', function() {
  saltPpm = 0;
  updateDisplay();
  updateUpgradeButtons();
  updatePrestigeInfo();
  lastUpdateTime = Date.now();
  requestAnimationFrame(gameLoop);
});
function gameLoop() {
  const now = Date.now();
  const deltaTime = (now - lastUpdateTime) / 1000;
  lastUpdateTime = now;
  // 自動溶解
  if (autoDissolveLv > 0) {
    const dissolveAmount = 0.1 * autoDissolveLv * deltaTime;
    saltPpm += dissolveAmount;
  }
  // 自然侵蝕
  if (naturalErosionLv > 0) {
    const erosionAmount = 0.05 * naturalErosionLv * deltaTime;
    saltPpm += erosionAmount;
  }
  // 蒸發
  if (evaporationLv > 0) {
    const evaporationAmount = 0.02 * evaporationLv * deltaTime;
    waterVolume = Math.max(100, waterVolume - evaporationAmount);
  }
  updateDisplay();
  updateUpgradeButtons();
  updatePrestigeInfo();
  requestAnimationFrame(gameLoop);
}
</script>
</body>
</html>
